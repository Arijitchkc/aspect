# In this variation on chunk_lithostatic_pressure_2d.prm
# we test whether the point_is_in_domain function
# handles the initial topography correctly. We therefore
# add an initial topography and pick a representative point
# for the initial lithostatic pressure that lies above
# the unperturbed surface but below the surface plus
# initial topography.

include $ASPECT_SOURCE_DIR/tests/chunk_lithostatic_pressure_2d.prm

set Dimension = 3
set End time                               = 0

subsection Geometry model
  set Model name = chunk

  subsection Chunk
    set Chunk inner radius = 3471000
    set Chunk outer radius = 6371000
    set Chunk minimum longitude = 10
    set Chunk maximum longitude = 50
    set Chunk minimum latitude = 0
    set Chunk maximum latitude = 40
  end

  subsection Initial topography model
    set Model name = function

    subsection Function
      set Function expression = 5000
      set Maximum topography value = 5000
    end
  end
end


subsection Boundary traction model
  set Prescribed traction boundary indicators = east: initial lithostatic pressure

  # Set a radius between 6371 and 6376 km (surface radius
  # without and with initial topography.
  subsection Initial lithostatic pressure
    set Representative point =  6374000, 50, 40
  end
end
